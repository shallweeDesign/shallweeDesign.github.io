window.Subjx=function(n){var r={};function o(t){if(r[t])return r[t].exports;var e=r[t]={i:t,l:!1,exports:{}};return n[t].call(e.exports,e,e.exports,o),e.l=!0,e.exports}return o.m=n,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=1)}([function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(0);var j=requestAnimationFrame||mozRequestAnimationFrame||webkitRequestAnimationFrame||msRequestAnimationFrame||function(t){return setTimeout(t,1e3/60)},a=cancelAnimationFrame||mozCancelAnimationFrame||function(t){clearTimeout(t)},o=(Array.prototype.forEach,Array.prototype.slice),r=Array.prototype.map,i=Array.prototype.reduce,Ot=console.warn;function N(t){return null!=t}function D(t){return null==t}function u(t){return"function"==typeof t}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.observers={}}return function(t,e,n){e&&s(t.prototype,e),n&&s(t,n)}(t,[{key:"subscribe",value:function(t,e){var n=this.observers;D(n[t])&&Object.defineProperty(n,t,{value:[]}),n[t].push(e)}},{key:"unsubscribe",value:function(t,e){var n=this.observers;if(N(n[t])){var r=n[t].indexOf(e);n[t].splice(r,1)}}},{key:"notify",value:function(e,n,r){D(this.observers[e])||this.observers[e].forEach(function(t){if(n!==t)switch(e){case"onmove":t.notifyMove(r);break;case"onrotate":t.notifyRotate(r);break;case"onresize":t.notifyResize(r);break;case"onapply":t.notifyApply(r);break;case"ongetstate":t.notifyGetState(r)}})}}]),t}();function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function h(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var f=function(){function a(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),!t)return this;if("string"==typeof t){var e=document.querySelectorAll(t);this.length=e.length;for(var n=0;n<this.length;n++)this[n]=e[n]}else if(1===t.nodeType||t===document)this[0]=t,this.length=1;else if(t instanceof Subjx||"object"===l(t)){this.length=t.length;for(var r=0;r<this.length;r++)this[r]=t[r]}else if(Array.isArray(t))for(var o=this.length=0;o<this.length;o++)1===t.nodeType&&(this[o]=t[o],this.length++);return this}return function(t,e,n){e&&h(t.prototype,e),n&&h(t,n)}(a,[{key:"css",value:function(t){return function(n){var t={setStyle:function(t){return function(t,e){var n=t.length;for(;n--;)for(var r in e)t[n].style[r]=e[r];return t.style}(this,t)},getStyle:function(){return function(t){var e=t.length;for(;e--;)return t[e].currentStyle?t[e].currentStyle[n]:document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t[e],"")[n]:t[e].style[n]}(this)}};{if("string"==typeof n)return t.getStyle.apply(this,o.call(arguments,1));if("object"===l(n)||!n)return t.setStyle.apply(this,arguments);Ot("Method ".concat(n," does not exist"))}return!1}.call(this,t)}},{key:"find",value:function(t){return function(t){var e=this.length;for(;e--;)return z(this[e].querySelectorAll(t))}.call(this,t)}},{key:"each",value:function(t){return function(t){for(var e=o.call(this,0),n=e.length-1;0<=n;--n)r=n,t.call(e[r]);var r;return this}.call(this,t)}},{key:"on",value:function(){return function(){var t=this.length;for(;t--;)this[t].events||(this[t].events={},this[t].events[arguments[0]]=[]),2===arguments.length?document.addEventListener?this[t].addEventListener(arguments[0],arguments[1],!1):document.attachEvent?this[t].attachEvent("on".concat(arguments[0]),arguments[1]):this[t]["on".concat(arguments[0])]=arguments[1]:3===arguments.length&&"string"==typeof arguments[1]&&p(this[t],arguments[0],arguments[1],arguments[2],!0);return this}.apply(this,arguments)}},{key:"off",value:function(){return function(){var t=this.length;for(;t--;)this[t].events||(this[t].events={},this[t].events[arguments[0]]=[]),2===arguments.length?document.removeEventListener?this[t].removeEventListener(arguments[0],arguments[1],!1):document.detachEvent?this[t].detachEvent("on".concat(arguments[0]),arguments[1]):this[t]["on".concat(arguments[0])]=null:3===arguments.length&&"string"==typeof arguments[1]&&p(this[t],arguments[0],arguments[1],arguments[2],!1);return this}.apply(this,arguments)}},{key:"is",value:function(t){return function(t){var e=z(t),n=this.length;for(;n--;)if(this[n]===e[n])return!0;return!1}.call(this,t)}}]),a}();function p(t,e,n,r,o){function a(t){for(var e=t.target;e&&e!==this;)e.matches(n)&&r.call(e,t),e=e.parentNode}!0===o?document.addEventListener?t.addEventListener(e,a,!1):document.attachEvent?t.attachEvent("on".concat(e),a):t["on".concat(e)]=a:document.removeEventListener?t.removeEventListener(e,a,!1):document.detachEvent?t.detachEvent("on".concat(e),a):t["on".concat(e)]=null}function z(t){return new f(t)}function _(t){return t.getBoundingClientRect()}function w(t){return t.css("-webkit-transform")||t.css("-moz-transform")||t.css("-ms-transform")||t.css("-o-transform")||t.css("transform")||"none"}function M(t){var e=t.match(/-?\d+\.?\d+|-?\d+/g);return e?e.map(function(t){return parseFloat(t)}):[1,0,0,1,0,0]}function V(e,t){if(t){if(e.classList){if(!(-1<t.indexOf(" ")))return e.classList.add(t);t.split(/\s+/).forEach(function(t){return e.classList.add(t)})}return e}}var v=/px|em|%|ex|ch|rem|vh|vw|vmin|vmax|mm|cm|in|pt|pc|deg/,R=Math.PI/180;Math.PI;function P(t,e){if(0===e)return t;var n=function(t,e){return 0===e?t:Math.round(t/e)*e}(t,e);return n-t<e?n:void 0}function k(t,e,n,r,o,a,i){var s=parseFloat(n)/2,c=parseFloat(r)/2,u=t+s,l=e+c,h=t-u,f=e-l,p=Math.atan2(f,h)+o,v=Math.sqrt(Math.pow(s,2)+Math.pow(c,2)),y=Math.cos(p),d=Math.sin(p),m=l+v*(d=!0===i?-d:d);return{left:b(u+v*(y=!0===a?-y:y)),top:b(m)}}function T(t,e){return/px/.test(t)?t:/%/.test(t)?"".concat(parseFloat(t)*parseFloat(e)/100,"px"):void 0}function x(t,e,n){return/px/.test(n)?t:/%/.test(n)?"".concat(100*parseFloat(t)/parseFloat(e),"%"):void 0}function E(t){return t.match(v)[0]}function b(t){return Number(t.toFixed(6))}function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var d=function(){function n(t,e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.constructor===n)throw new TypeError("Cannot construct Subject instances directly");this.el=t,this.storage=null,this.proxyMethods=null,this.Ob=e,this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._animate=this._animate.bind(this)}return function(t,e,n){e&&y(t.prototype,e),n&&y(t,n)}(n,[{key:"enable",value:function(t){D(this.storage)?(this._load(t),this._init(this.el)):Ot("Already enabled")}},{key:"disable",value:function(){var t=this.storage,e=this.proxyMethods,n=this.el,r=this.Ob;D(t)||(t.onExecution&&(this._end(),z(document).off("mousemove",this._onMouseMove).off("mouseup",this._onMouseUp).off("touchmove",this._onTouchMove).off("touchend",this._onTouchEnd)),function(e,t){if(t){if(e.classList){if(!(-1<t.indexOf(" ")))return e.classList.remove(t);t.split(/\s+/).forEach(function(t){return e.classList.remove(t)})}}}(n,"dg-drag"),this._destroy(),r.unsubscribe("ongetstate",this),r.unsubscribe("onapply",this),r.unsubscribe("onmove",this),r.unsubscribe("onresize",this),r.unsubscribe("onrotate",this),e.onDestroy.call(this,n),delete this.storage)}},{key:"_init",value:function(){}},{key:"_destroy",value:function(){}},{key:"_cursorPoint",value:function(){}},{key:"_drag",value:function(){var t;this._processMove.apply(this,arguments),(t=this.proxyMethods.onMove).call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_rotate",value:function(){var t;this._processRotate.apply(this,arguments),(t=this.proxyMethods.onRotate).call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_resize",value:function(){var t;this._processResize.apply(this,arguments),(t=this.proxyMethods.onResize).call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"_load",value:function(t){var e=this.el,n=this.Ob;V(e,"dg-drag");var r={x:10,y:10,angle:10*R},o={move:!1,resize:!1,rotate:!1},a=!0,i=null,s=function(){},c=function(){},u=function(){},l=function(){},h=function(){},f=function(){},p=e.parentNode,v=!1;if(N(t)){var y=t.snap,d=t.each,m=t.showHandles,b=t.restrict,g=t.onInit,x=t.onDrop,_=t.onMove,w=t.onResize,M=t.onRotate,k=t.onDestroy,T=t.container,E=t.proportions;if(N(y)){var S=y.x,A=y.y,O=y.angle;r.x=D(S)?10:S,r.y=D(A)?10:A,r.angle=D(O)?r.angle:O*R}if(N(d)){var j=d.move,P=d.resize,C=d.rotate;o.move=j||!1,o.resize=P||!1,o.rotate=C||!1}N(b)&&(i="parent"===b?e.parentNode:z(b)[0]||document),a=D(m)||!0===m,p=z(T)[0]||p,v=E||!1,s=X(g),h=X(x),c=X(_),l=X(w),u=X(M),f=X(k),s.call(this,e)}this.storage={showHandles:a,restrict:i,container:p,snap:r,each:o,proportions:v},this.proxyMethods={onInit:s,onDrop:h,onMove:c,onResize:l,onRotate:u,onDestroy:f},(o.move||o.resize||o.rotate)&&(n.subscribe("ongetstate",this),n.subscribe("onapply",this)),o.move&&n.subscribe("onmove",this),o.resize&&n.subscribe("onresize",this),o.rotate&&n.subscribe("onrotate",this)}},{key:"_draw",value:function(){this._animate()}},{key:"_animate",value:function(){var t=this,e=t.storage;if(!D(e)&&(e.frame=j(t._animate),e.doDraw)){e.doDraw=!1;var n=e.handle,r=e.handles,o=e.cx,a=e.cy,i=e.nx,s=e.ny,c=e.pressang,u=e.clientX,l=e.clientY,h=e.center,f=e.snap,p=e.doDrag,v=e.doResize,y=e.doRotate,d=e.revX,m=e.revY,b=e.each,g=b.move,x=b.resize,_=b.rotate;if(v){var w=this._pointToElement({x:u,y:l}),M=w.x,k=w.y,T=P(M-o,f.x),E=P(k-a,f.y);T=n.is(r.ml)||n.is(r.mr)||n.is(r.tl)||n.is(r.tr)||n.is(r.bl)||n.is(r.br)?d?-T:T:0,E=n.is(r.br)||n.is(r.bl)||n.is(r.bc)||n.is(r.tr)||n.is(r.tl)||n.is(r.tc)?m?-E:E:0,t._resize(T,E),x&&t.Ob.notify("onresize",t,{dx:T,dy:E})}if(p){var S=P(u-i,f.x),A=P(l-s,f.y);t._drag(S,A),g&&t.Ob.notify("onmove",t,{dx:S,dy:A})}if(y){var O=Math.atan2(l-h.y,u-h.x)-c;t._rotate(P(O,f.angle)),_&&t.Ob.notify("onrotate",t,{radians:O})}}}},{key:"_start",value:function(t){t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.storage,n=this._compute(t);Object.keys(n).forEach(function(t){e[t]=n[t]});var r=n.onRightEdge,o=n.onBottomEdge,a=n.onTopEdge,i=n.onLeftEdge,s=n.handle,c=n.factor,u=n.revX,l=n.revY,h=r||o||a||i,f=s.is(e.handles.rotator),p=t.clientX,v=t.clientY,y=t.ctrlKey,d=this._cursorPoint({clientX:p,clientY:v}),m=d.x,b=d.y,g=this._pointToElement({x:m,y:b}),x=g.x,_=g.y;e.clientX=p,e.clientY=v,e.nx=m,e.ny=b,e.cx=x,e.cy=_,e.ctrlKey=y,e.doResize=h,e.doDrag=!f&&!h,e.doRotate=f,e.onExecution=!0,this.Ob.notify("ongetstate",this,{factor:c,revX:u,revY:l}),this._draw()}},{key:"_moving",value:function(t){t.preventDefault&&t.preventDefault();var e=this.storage,n=this._cursorPoint(t),r=n.x,o=n.y;e.clientX=r,e.clientY=o,e.doDraw=!0}},{key:"_end",value:function(t){N(t)&&t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.storage,n=this.proxyMethods,r=e.doResize?"resize":e.doDrag?"drag":"rotate";e.doResize=!1,e.doDrag=!1,e.doRotate=!1,e.doDraw=!1,e.onExecution=!1,this._apply(r),this.Ob.notify("onapply",this,r),a(e.frame),n.onDrop.call(this,t,this.el)}},{key:"_onMouseDown",value:function(t){this._start(t),z(document).on("mousemove",this._onMouseMove).on("mouseup",this._onMouseUp)}},{key:"_onTouchStart",value:function(t){this._start(t.touches[0]),z(document).on("touchmove",this._onTouchMove).on("touchend",this._onTouchEnd)}},{key:"_onMouseMove",value:function(t){this._moving(t,this.el)}},{key:"_onTouchMove",value:function(t){this._moving(t.touches[0],this.el)}},{key:"_onMouseUp",value:function(t){z(document).off("mousemove",this._onMouseMove).off("mouseup",this._onMouseUp),this._end(t,this.el)}},{key:"_onTouchEnd",value:function(t){z(document).off("touchmove",this._onTouchMove).off("touchend",this._onTouchEnd),0===t.touches.length&&this._end(t.changedTouches[0],this.el)}},{key:"notifyMove",value:function(t){var e=t.dx,n=t.dy;this._drag(e,n)}},{key:"notifyRotate",value:function(t){var e=this.storage.snap;this._rotate(P(t.radians,e.angle))}},{key:"notifyResize",value:function(t){var e=t.dx,n=t.dy,r=t.dox,o=t.doy;this._resize(e,n,r,o)}},{key:"notifyApply",value:function(t){this._apply(t)}},{key:"notifyGetState",value:function(t){var e=this.storage,n=this._getState(t);Object.keys(n).forEach(function(t){e[t]=n[t]})}}]),n}();function X(t){return u(t)?function(){t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))}:function(){}}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function A(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function O(t,e){return!e||"object"!==g(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Y(t,e){return(Y=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var L=function(){function o(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=O(this,C(o).call(this,t,n))).enable(e),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Y(t,e)}(o,d),function(t,e,n){e&&A(t.prototype,e),n&&A(t,n)}(o,[{key:"_init",value:function(t){var e=this.storage,n=document.createElement("div");V(n,"dg-wrapper"),t.parentNode.insertBefore(n,t);var r=z(t),o=t.style,a=o.left,i=o.top,s=o.width,c=o.height,u=s||r.css("width"),l=c||r.css("height"),h=i||r.css("top"),f=a||r.css("left"),p=z(n.parentNode),v={top:h,left:f,width:u,height:l,transform:w(r)},y=document.createElement("div");y.innerHTML='\n        <div class="dg dg-normal"></div>\n        <div class="dg-hdl dg-hdl-t dg-hdl-l dg-hdl-tl"></div>\n        <div class="dg-hdl dg-hdl-t dg-hdl-r dg-hdl-tr"></div>\n        <div class="dg-hdl dg-hdl-b dg-hdl-r dg-hdl-br"></div>\n        <div class="dg-hdl dg-hdl-b dg-hdl-l dg-hdl-bl"></div>\n        <div class="dg-hdl dg-hdl-t dg-hdl-c dg-hdl-tc"></div>\n        <div class="dg-hdl dg-hdl-b dg-hdl-c dg-hdl-bc"></div>\n        <div class="dg-hdl dg-hdl-m dg-hdl-l dg-hdl-ml"></div>\n        <div class="dg-hdl dg-hdl-m dg-hdl-r dg-hdl-mr"></div>\n        <div class="dg-hdl dg-rotator"></div>',V(y,"dg-controls"),n.appendChild(y);var d=z(y);d.css(v);var m=z(n);Object.assign(e,{controls:y,handles:{tl:m.find(".dg-hdl-tl"),tr:m.find(".dg-hdl-tr"),br:m.find(".dg-hdl-br"),bl:m.find(".dg-hdl-bl"),tc:m.find(".dg-hdl-tc"),bc:m.find(".dg-hdl-bc"),ml:m.find(".dg-hdl-ml"),mr:m.find(".dg-hdl-mr"),rotator:m.find(".dg-rotator")},parent:p}),d.on("mousedown",this._onMouseDown).on("touchstart",this._onTouchStart)}},{key:"_destroy",value:function(){var t=this.storage,e=t.controls,n=t.container;z(e).off("mousedown",this._onMouseDown).off("touchstart",this._onTouchStart),n.removeChild(e.parentNode)}},{key:"_compute",value:function(t){var e=this.storage.handles,n=z(t.target),r=n.is(e.tl)||n.is(e.ml)||n.is(e.bl)||n.is(e.tc),o=n.is(e.tl)||n.is(e.tr)||n.is(e.tc)||n.is(e.ml),a=n.is(e.tl)||n.is(e.tc)||n.is(e.tr),i=n.is(e.tl)||n.is(e.ml)||n.is(e.bl),s=n.is(e.tr)||n.is(e.mr)||n.is(e.br),c=n.is(e.br)||n.is(e.bc)||n.is(e.bl),u=n.is(e.tr)||n.is(e.bl)?-1:1,l=this._getState({factor:u,revX:r,revY:o}),h=this._cursorPoint(t),f=h.x,p=h.y,v=Math.atan2(p-l.center.y,f-l.center.x);return l.onTopEdge=a,l.onLeftEdge=i,l.onRightEdge=s,l.onBottomEdge=c,l.handle=n,l.pressang=v,l}},{key:"_pointToElement",value:function(t){var e=this.storage.transform,n=t.x,r=t.y,o=S(e.matrix);return o[4]=o[5]=0,F({x:n,y:r},I(o))}},{key:"_cursorPoint",value:function(t){var e=M(w(z(this.storage.container)));return F({x:t.clientX,y:t.clientY},I(e))}},{key:"_apply",value:function(){var t=this.storage,e=z(this.el),n=t.cached,r=t.parent,o=t.dimens,a=t.controls;if(n){var i=S(n),s=r.css("width"),c=r.css("height"),u=i[4],l=i[5];i[4]=0,i[5]=0;var h=B(i),f=parseFloat(T(e[0].style.left||e.css("left"),s)),p=parseFloat(T(e[0].style.top||e.css("top"),c));h.left=x(f+u+"px",s,o.left),h.top=x(p+l+"px",c,o.top),e.css(h),z(a).css(h),this.storage.cached=null}}},{key:"getControls",value:function(){return this.storage.controls}},{key:"_processResize",value:function(t,e){var n=this.el,r=this.storage,o=r.controls,a=r.coords,i=r.cw,s=r.ch,c=r.dimens,u=r.parent,l=r.transform,h=r.refang,f=r.revX,p=r.revY,v=o.style,y=i+t,d=s+e;if(!(y<2||d<2)){v.width="".concat(y,"px"),v.height="".concat(d,"px");var m=S(l.matrix),b=k(m[4],m[5],y,d,h,f,p);m[4]-=b.left-a.left,m[5]-=b.top-a.top;var g=B(m);z(o).css(g),g.width=x(v.width,u.css("width"),c.width),g.height=x(v.height,u.css("height"),c.height),z(n).css(g),r.cached=m}}},{key:"_processMove",value:function(t,e){var n=this.el,r=this.storage,o=r.controls,a=r.transform,i=a.matrix,s=(a.parentMatrix,S(i));s[4]=i[4]+t,s[5]=i[5]+e;var c=B(s);z(o).css(c),z(n).css(c),r.cached=s}},{key:"_processRotate",value:function(t){var e=this.el,n=this.storage,r=n.controls,o=n.transform,a=o.matrix,i=o.parentMatrix,s=b(Math.cos(t)),c=b(Math.sin(t)),u=[s,c,-c,s,0,0],l=S(i);l[4]=l[5]=0;var h=U(U(I(l),U(u,l)),a),f=B(h);z(r).css(f),z(e).css(f),n.cached=h}},{key:"_getState",value:function(t){var e=t.factor,n=t.revX,r=t.revY,o=this.el,a=this.storage,i=a.handles,s=a.controls,c=a.parent,u=_(i.tl[0]),l=_(i.tr[0]),h=Math.atan2(l.top-u.top,l.left-u.left)*e,f=parseFloat(T(s.style.width,c.css("width"))),p=parseFloat(T(s.style.height,c.css("height"))),v=z(o),y=o.style,d={top:E(y.top||v.css("top")),left:E(y.left||v.css("left")),width:E(y.width||v.css("width")),height:E(y.height||v.css("height"))},m={matrix:M(w(z(s))),parentMatrix:M(w(c))},b=k(m.matrix[4],m.matrix[5],f,p,h,n,r),g=_(o),x=F({x:g.left+f/2,y:g.top+p/2},I(m.parentMatrix));return{transform:m,cw:f,ch:p,coords:b,center:{x:x.x,y:x.y},factor:e,refang:h,revX:n,revY:r,dimens:d}}}]),o}();function B(t){var e="matrix(".concat(t.join(),")");return{transform:e,webkitTranform:e,mozTransform:e,msTransform:e,otransform:e}}function F(t,e){var n=t.x,r=t.y,o=m(e,6),a=o[0],i=o[1],s=o[2],c=o[3];return{x:a*n+s*r+o[4],y:i*n+c*r+o[5]}}function I(t){var e=[[t[0],t[2],t[4]],[t[1],t[3],t[5]],[0,0,1]];if(e.length===e[0].length){for(var n=e.length,r=[],o=[],a=0;a<n;a+=1){r[r.length]=[],o[o.length]=[];for(var i=0;i<n;i+=1)r[a][i]=a==i?1:0,o[a][i]=e[a][i]}for(var s=0;s<n;s+=1){var c=o[s][s];if(0===c){for(var u=s+1;u<n;u+=1)if(0!==o[u][s]){for(var l=0;l<n;l++)c=o[s][l],o[s][l]=o[u][l],o[u][l]=c,c=r[s][l],r[s][l]=r[u][l],r[u][l]=c;break}if(0===(c=o[s][s]))return}for(var h=0;h<n;h++)o[s][h]=o[s][h]/c,r[s][h]=r[s][h]/c;for(var f=0;f<n;f++)if(f!=s){c=o[f][s];for(var p=0;p<n;p++)o[f][p]-=c*o[s][p],r[f][p]-=c*r[s][p]}}return[r[0][0],r[1][0],r[0][1],r[1][1],r[0][2],r[1][2]]}}function U(t,e){for(var n=[[t[0],t[2],t[4]],[t[1],t[3],t[5]],[0,0,1]],r=[[e[0],e[2],e[4]],[e[1],e[3],e[5]],[0,0,1]],o=[],a=0;a<r.length;a++){o[a]=[];for(var i=0;i<n[0].length;i++){for(var s=0,c=0;c<n.length;c++)s+=n[c][i]*r[a][c];o[a].push(s)}}return[o[0][0],o[1][0],o[0][1],o[1][1],o[0][2],o[1][2]]}var q=["circle","ellipse","image","line","path","polygon","polyline","rect","text","g"];function G(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function H(){return G("svg").createSVGMatrix()}function ot(t,e){return(e.getScreenCTM()||H()).inverse().multiply(t.getScreenCTM()||H())}function K(t){return"matrix(".concat(t.a,",").concat(t.b,",").concat(t.c,",").concat(t.d,",").concat(t.e,",").concat(t.f,")")}function jt(t,e,n,r){var o=e.createSVGPoint();return o.x=n,o.y=r,o.matrixTransform(t)}function Pt(t){var e=H();return e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.e=t.e,e.f=t.f,e}function Q(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Ct(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,o=!1,a=void 0;try{for(var i,s=t[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!e||n.length!==e);r=!0);}catch(t){o=!0,a=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var Z=/\s*([achlmqstvz])([^achlmqstvz]*)\s*/gi,$=/\s*,\s*|\s+/g;function Nt(t){for(var e=Z.lastIndex=0,n=[];e=Z.exec(t);){var r=e[1],o=r.toUpperCase(),a=e[2].replace(/([^e])-/g,"$1 -").replace(/ +/g," ");n.push({relative:r!==o,key:o,cmd:r,values:a.trim().split($).map(function(t){if(!isNaN(t))return Number(t)})})}return n}function J(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function et(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function nt(t){return(nt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rt(t,e){return(rt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var at=/[+-]?\d+(\.\d+)?/g,it=function(){function o(t,e,n){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),(r=et(this,nt(o).call(this,t,n))).enable(e),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&rt(t,e)}(o,d),function(t,e,n){e&&tt(t.prototype,e),n&&tt(t,n)}(o,[{key:"_init",value:function(t){var e=this.storage,n=e.showHandles,r=e.container,o=G("g");r.appendChild(o);var a=t.getBBox(),i=a.width,s=a.height,c=a.x,u=a.y,l=ot(t,r),h=G("rect");[["width",i],["height",s],["x",c],["y",u],["fill","rgba(0, 168, 255, 0.2)"],["stroke","#00a8ff"],["stroke-dasharray","3 3"],["vector-effect","non-scaling-stroke"],["transform",K(l)]].forEach(function(t){h.setAttribute(t[0],t[1])});var f=G("g"),p=G("g"),v=G("g");v.appendChild(h),o.appendChild(v),o.appendChild(p),o.appendChild(f);var y=h.getBBox(),d=y.x,m=y.y,b=y.width,g=y.height,x=ot(h,h.parentNode),_={tl:jt(x,r,d,m),tr:jt(x,r,d+b,m),br:jt(x,r,d+b,m+g),bl:jt(x,r,d,m+g),tc:jt(x,r,d+b/2,m),bc:jt(x,r,d+b/2,m+g),ml:jt(x,r,d,m+g/2),mr:jt(x,r,d+b,m+g/2),rotator:{}},w=Math.atan2(_.tl.y-_.tr.y,_.tl.x-_.tr.x);_.rotator.x=_.mr.x-50*Math.cos(w),_.rotator.y=_.mr.y-50*Math.sin(w);var M=G("line");n&&(M.x1.baseVal.value=_.mr.x,M.y1.baseVal.value=_.mr.y,M.x2.baseVal.value=_.rotator.x,M.y2.baseVal.value=_.rotator.y,M.setAttribute("stroke","#00a8ff"),M.setAttribute("stroke-dasharray","3 3"),M.setAttribute("vector-effect","non-scaling-stroke"),p.appendChild(M)),Object.keys(_).forEach(function(t){var e=_[t];_[t]=function(t,e){var n=G("circle"),r={cx:t,cy:e,r:"5",fill:"rgba(0, 168, 255, 0.2)",stroke:"#00a8ff","vector-effect":"non-scaling-stroke"};return Object.keys(r).map(function(t){n.setAttribute(t,r[t])}),n}(e.x,e.y),n&&f.appendChild(_[t])}),Object.assign(e,{wrapper:o,box:h,handles:_,normalLine:M,parent:t.parentNode}),z(o).on("mousedown",this._onMouseDown).on("touchstart",this._onTouchStart)}},{key:"_destroy",value:function(){var t=this.storage,e=t.wrapper,n=t.container;z(e).off("mousedown",this._onMouseDown).off("touchstart",this._onTouchStart),n.removeChild(e)}},{key:"_compute",value:function(t){var e=this.storage.handles,n=z(t.target),r=n.is(e.tl)||n.is(e.ml)||n.is(e.bl)||n.is(e.tc),o=n.is(e.tl)||n.is(e.tr)||n.is(e.tc)||n.is(e.ml),a=n.is(e.tl)||n.is(e.tc)||n.is(e.tr),i=n.is(e.tl)||n.is(e.ml)||n.is(e.bl),s=n.is(e.tr)||n.is(e.mr)||n.is(e.br),c=n.is(e.br)||n.is(e.bc)||n.is(e.bl),u=this._getState({revX:r,revY:o}),l=this._cursorPoint(t),h=l.x,f=l.y,p=Math.atan2(f-u.center.y,h-u.center.x);return u.onTopEdge=a,u.onLeftEdge=i,u.onRightEdge=s,u.onBottomEdge=c,u.handle=n,u.pressang=p,u}},{key:"_cursorPoint",value:function(t){var e=this.storage.container;return jt(e.getScreenCTM().inverse(),e,t.clientX,t.clientY)}},{key:"_pointToElement",value:function(t){var e=this.storage,n=e.transform,r=e.container,o=t.x,a=t.y,i=n.ctm.inverse(),s=r.createSVGPoint();return s.x=o,s.y=a,i.e=i.f=0,s.matrixTransform(i)}},{key:"_apply",value:function(t){var i=this.el,e=this.storage,s=e.container,n=e.box,r=e.handles,o=e.normalLine,a=e.cached,c=e.transform;if(!D(a)){var u=a.scaleX,l=a.scaleY,h=a.dx,f=a.dy,p=a.ox,v=a.oy,y=c.matrix;if("drag"===t){if(0===h&&0===f)return;var d=H();d.e=h,d.f=f;var m=d.multiply(y).multiply(d.inverse());if(i.setAttribute("transform",K(m)),lt(i))ht(i).forEach(function(t){var e=s.createSVGPoint(),n=ot(i.parentNode,s).inverse();e.x=p,e.y=v,n.e=n.f=0;var r=e.matrixTransform(n),o=H();o.e=h,o.f=f;var a=o.multiply(ot(t,t.parentNode)).multiply(o.inverse());t.setAttribute("transform",K(a)),lt(t)||st(t,{x:r.x,y:r.y})});else st(i,{x:h,y:f})}if("resize"===t){var b=n.getBBox();if(ut(n,r,o,{x:b.x,y:b.y,width:b.width,height:b.height},s),lt(i))ht(i).forEach(function(t){lt(t)||ct(t,{scaleX:u,scaleY:l,defaultCTM:t.__ctm__,bBox:c.bBox,container:s,storage:e})});else ct(i,{scaleX:u,scaleY:l,defaultCTM:c.ctm,bBox:c.bBox,container:s,storage:e});i.setAttribute("transform",K(y))}this.storage.cached=null}}},{key:"getControls",value:function(){return this.storage.wrapper}},{key:"_processResize",value:function(t,e){var n=this.storage,r=n.container,o=n.box,a=n.handles,i=n.normalLine,s=n.left,c=n.top,u=n.cw,l=n.ch,h=n.transform,f=n.revX,p=n.revY,v=h.matrix,y=h.scMatrix,d=h.trMatrix,m=h.scaleX,b=h.scaleY,g=this.el,x=o.getBBox(),_=x.width,w=x.height;if(_=u+t,w=l+e,!(Math.abs(_)<2||Math.abs(w)<2)){var M=_/u,k=w/l;y.a=M,y.b=0,y.c=0,y.d=k,y.e=0,y.f=0,d.e=m,d.f=b;var T=d.multiply(y).multiply(d.inverse()),E=v.multiply(T);g.setAttribute("transform",K(E)),this.storage.cached={scaleX:M,scaleY:k},ut(o,a,i,{x:f?s-t:s,y:p?c-e:c,width:_,height:w},r)}}},{key:"_processMove",value:function(t,e){var n=this.storage,r=n.container,o=n.transform,a=n.wrapper,i=o.matrix,s=o.trMatrix,c=o.scMatrix,u=o.wrapperMatrix,l=o.parentMatrix;c.e=t,c.f=e;var h=c.multiply(u);a.setAttribute("transform",K(h)),l.e=l.f=0;var f=jt(l.inverse(),r,t,e),p=f.x,v=f.y;s.e=p,s.f=v;var y=s.multiply(i);this.el.setAttribute("transform",K(y)),this.storage.cached={dx:p,dy:v,ox:t,oy:e}}},{key:"_processRotate",value:function(t){var e=this.storage,n=e.center,r=e.transform,o=e.wrapper,a=r.matrix,i=r.wrapperMatrix,s=r.parentMatrix,c=r.trMatrix,u=r.scMatrix,l=r.rotMatrix,h=b(Math.cos(t)),f=b(Math.sin(t));c.e=n.x,c.f=n.y,l.a=h,l.b=f,l.c=-f,l.d=h;var p=c.multiply(l).multiply(c.inverse()).multiply(i);o.setAttribute("transform",K(p)),u.e=n.el_x,u.f=n.el_y,s.e=s.f=0;var v=s.inverse().multiply(l).multiply(s),y=u.multiply(v).multiply(u.inverse()).multiply(a);this.el.setAttribute("transform",K(y))}},{key:"_getState",value:function(t){var e=t.revX,n=t.revY,r=this.el,o=this.storage,a=o.container,i=o.box,s=o.wrapper,c=o.parent,u=this.el.getBBox(),l=u.x,h=u.y,f=u.width,p=u.height,v=i.getBBox(),y=v.width,d=v.height,m=v.x,b=v.y,g=ot(r,c),x=i.parentNode,_={matrix:g,ctm:ot(r,a),wrapperMatrix:ot(s,s.parentNode),boxCTM:ot(x,a),boxMatrix:ot(x,x.parentNode),parentMatrix:ot(c,a),trMatrix:H(),scMatrix:H(),rotMatrix:H(),scaleX:e?f+l:l,scaleY:n?p+h:h,bBox:u},w=y/2,M=d/2,k=jt(ot(i,a),a,m+w,b+M),T=jt(g,a,l+f/2,h+p/2);return ht(r).forEach(function(t){t.__ctm__=ot(t,a)}),{transform:_,cw:y,ch:d,center:{x:k.x,y:k.y,el_x:T.x,el_y:T.y},left:m,top:b,revX:e,revY:n}}}]),o}();function st(e,t){var n=t.x,r=t.y,o=[];switch(e.tagName.toLowerCase()){case"use":case"image":case"text":case"rect":var a=Number(e.getAttribute("x"))+n,i=Number(e.getAttribute("y"))+r;o.push(["x",a],["y",i]);break;case"circle":case"ellipse":var s=Number(e.getAttribute("cx"))+n,c=Number(e.getAttribute("cy"))+r;o.push(["cx",s],["cy",c]);break;case"line":var u=Number(e.getAttribute("x1"))+n,l=Number(e.getAttribute("y1"))+r,h=Number(e.getAttribute("x2"))+n,f=Number(e.getAttribute("y2"))+r;o.push(["x1",u],["y1",l],["x2",h],["y2",f]);break;case"polygon":case"polyline":var p=ft(e.getAttribute("points")).map(function(t){return t[0]=Number(t[0])+n,t[1]=Number(t[1])+r,t.join(" ")}).join(" ");o.push(["points",p]);break;case"path":var v=e.getAttribute("d");o.push(["d",function(t){var e=t.path,n=t.dx,r=t.dy;try{for(var o=Nt(e),a="",i=" ",s=!0,c=0,u=o.length;c<u;c++){var l=o[c],h=l.values,f=l.key,p=l.relative,v=[];switch(f){case"M":for(var y=0,d=h.length;y<d;y+=2){var m=Ct(h.slice(y,y+2),2),b=m[0],g=m[1];p&&!s||(b+=n,g+=r),v.push(b,g),s=!1}break;case"A":for(var x=0,_=h.length;x<_;x+=7){var w=h.slice(x,x+7);p||(w[5]=w[5]+n,w[6]=w[6]+r),v.push.apply(v,Q(w))}break;case"C":for(var M=0,k=h.length;M<k;M+=6){var T=h.slice(M,M+6);p||(T[0]=T[0]+n,T[1]=T[1]+r,T[2]=T[2]+n,T[3]=T[3]+r,T[4]=T[4]+n,T[5]=T[5]+r),v.push.apply(v,Q(T))}break;case"H":for(var E=0,S=h.length;E<S;E+=1){var A=h.slice(E,E+1);p||(A[0]+=n),v.push(A[0])}break;case"V":for(var O=0,j=h.length;O<j;O+=1){var P=h.slice(O,O+1);p||(P[0]+=r),v.push(P[0])}break;case"L":case"T":for(var C=0,N=h.length;C<N;C+=2){var D=Ct(h.slice(C,C+2),2);b=D[0],g=D[1];p||(b+=n,g+=r),v.push(b,g)}break;case"Q":case"S":for(var z=0,V=h.length;z<V;z+=4){var R=Ct(h.slice(z,z+4),4),X=R[0],Y=R[1],L=R[2],B=R[3];p||(X+=n,Y+=r,L+=n,B+=r),v.push(X,Y,L,B)}break;case"Z":i=h[0]=""}a+=l.cmd+v.join(",")+i}return a}catch(t){Ot("Path parsing error: "+t)}}({path:v,dx:n,dy:r})])}o.forEach(function(t){e.setAttribute(t[0],t[1])})}function ct(e,t){var n=t.scaleX,r=t.scaleY,o=t.bBox,a=t.defaultCTM,i=t.container,s=o.width,c=o.height,u=[],l=ot(e,i),h=a.inverse().multiply(l);switch(e.tagName.toLowerCase()){case"text":var f=e.x.baseVal.value,p=e.y.baseVal.value,v=jt(h,i,f,p),y=v.x,d=v.y;u.push(["x",y+(n<0?s:0)],["y",d+(r<0?c:0)]);break;case"circle":var m=e.r.baseVal.value,b=e.cx.baseVal.value,g=e.cy.baseVal.value,x=m*(Math.abs(n)+Math.abs(r))/2,_=jt(h,i,b,g),w=_.x,M=_.y;u.push(["r",x],["cx",w],["cy",M]);break;case"image":case"rect":var k=e.width.baseVal.value,T=e.height.baseVal.value,E=e.x.baseVal.value,S=e.y.baseVal.value,A=jt(h,i,E,S),O=A.x,j=A.y;h.e=h.f=0;var P=jt(h,i,k,T),C=P.x,N=P.y,D=Math.abs(C),z=Math.abs(N);u.push(["x",O-(n<0?D:0)],["y",j-(r<0?z:0)],["width",D],["height",z]);break;case"ellipse":var V=e.rx.baseVal.value,R=e.ry.baseVal.value,X=e.cx.baseVal.value,Y=e.cy.baseVal.value,L=jt(h,i,X,Y),B=L.x,F=L.y;h.e=h.f=0;var I=jt(h,i,V,R),U=I.x,q=I.y;u.push(["rx",Math.abs(U)],["ry",Math.abs(q)],["cx",B],["cy",F]);break;case"line":var G=e.x1.baseVal.value,H=e.y1.baseVal.value,K=e.x2.baseVal.value,Q=e.y2.baseVal.value,Z=jt(h,i,G,H),$=Z.x,J=Z.y,W=jt(h,i,K,Q),tt=W.x,et=W.y;u.push(["x1",$],["y1",J],["x2",tt],["y2",et]);break;case"polygon":case"polyline":var nt=ft(e.getAttribute("points")).map(function(t){var e=jt(h,i,Number(t[0]),Number(t[1])),n=e.x,r=e.y;return t[0]=n,t[1]=r,t.join(" ")}).join(" ");u.push(["points",nt]);break;case"path":var rt=e.getAttribute("d");u.push(["d",function(t){var e=t.path,n=t.localCTM,r=t.container;try{for(var o=Nt(e),a="",i=" ",s=[],c=!0,u=0,l=o.length;u<l;u++){var h=o[u],f=h.values,p=h.key,v=h.relative;switch(p){case"A":for(var y=[],d=0,m=f.length;d<m;d+=7){var b=Ct(f.slice(d,d+7),7),g=b[0],x=b[1],_=b[2],w=b[3],M=b[4],k=b[5],T=b[6],E=Pt(n);v&&(E.e=E.f=0);var S=jt(E,r,k,T),A=S.x,O=S.y;y.push(A,O),E.e=E.f=0;var j=jt(E,r,g,x),P=j.x,C=j.y;y.unshift(P,C,_,w,M)}s.push(y);break;case"C":for(var N=[],D=0,z=f.length;D<z;D+=6){var V=Ct(f.slice(D,D+6),6),R=V[0],X=V[1],Y=V[2],L=V[3],B=(k=V[4],T=V[5],Pt(n));v&&(B.e=B.f=0);var F=jt(B,r,R,X),I=F.x,U=F.y,q=jt(B,r,Y,L),G=q.x,H=q.y,K=jt(B,r,k,T);A=K.x,O=K.y;N.push(I,U,G,H,A,O)}s.push(N);break;case"H":for(var Q=[],Z=0,$=f.length;Z<$;Z+=1){k=Ct(f.slice(Z,Z+1),1)[0];var J=Pt(n);v&&(J.e=J.f=0);A=jt(J,r,k,0).x;Q.push(A)}s.push(Q);break;case"V":for(var W=[],tt=0,et=f.length;tt<et;tt+=1){T=Ct(f.slice(tt,tt+1),1)[0];var nt=Pt(n);v&&(nt.e=nt.f=0);O=jt(nt,r,0,T).y;W.push(O)}s.push(W);break;case"T":case"L":for(var rt=[],ot=0,at=f.length;ot<at;ot+=2){var it=Ct(f.slice(ot,ot+2),2),st=(k=it[0],T=it[1],Pt(n));v&&(st.e=st.f=0);var ct=jt(st,r,k,T);A=ct.x,O=ct.y;rt.push(A,O)}s.push(rt);break;case"M":for(var ut=[],lt=0,ht=f.length;lt<ht;lt+=2){var ft=Ct(f.slice(lt,lt+2),2),pt=(k=ft[0],T=ft[1],Pt(n));v&&!c&&(pt.e=pt.f=0);var vt=jt(pt,r,k,T);A=vt.x,O=vt.y;ut.push(A,O),c=!1}s.push(ut);break;case"Q":for(var yt=[],dt=0,mt=f.length;dt<mt;dt+=4){var bt=Ct(f.slice(dt,dt+4),4),gt=(R=bt[0],X=bt[1],k=bt[2],T=bt[3],Pt(n));v&&(gt.e=gt.f=0);var xt=jt(gt,r,R,X),_t=(I=xt.x,U=xt.y,jt(gt,r,k,T));A=_t.x,O=_t.y;yt.push(I,U,A,O)}s.push(yt);break;case"S":for(var wt=[],Mt=0,kt=f.length;Mt<kt;Mt+=4){var Tt=Ct(f.slice(Mt,Mt+4),4),Et=(Y=Tt[0],L=Tt[1],k=Tt[2],T=Tt[3],Pt(n));v&&(Et.e=Et.f=0);var St=jt(Et,r,Y,L),At=(G=St.x,H=St.y,jt(n,r,k,T));A=At.x,O=At.y;wt.push(G,H,A,O)}s.push(wt);break;case"Z":s.push([""]),i=""}a+=h.cmd+s[u].join(",")+i}return a}catch(t){Ot("Path parsing error: "+t)}}({path:rt,localCTM:h,container:i})])}u.forEach(function(t){e.setAttribute(t[0],t[1])})}function ut(e,n,t,r,o){var a=r.x,i=r.y,s=r.width,c=r.height,u=s/2,l=c/2,h=ot(e,e.parentNode.parentNode),f={tl:jt(h,o,a,i),tr:jt(h,o,a+s,i),br:jt(h,o,a+s,i+c),bl:jt(h,o,a,i+c),tc:jt(h,o,a+u,i),bc:jt(h,o,a+u,i+c),ml:jt(h,o,a,i+l),mr:jt(h,o,a+s,i+l),rotator:{}},p=Math.atan2(f.tl.y-f.tr.y,f.tl.x-f.tr.x);f.rotator.x=f.mr.x-50*Math.cos(p),f.rotator.y=f.mr.y-50*Math.sin(p),t.x1.baseVal.value=f.mr.x,t.y1.baseVal.value=f.mr.y,t.x2.baseVal.value=f.rotator.x,t.y2.baseVal.value=f.rotator.y;var v={x:a+=s<0?s:0,y:i+=c<0?c:0,width:Math.abs(s),height:Math.abs(c)};Object.keys(v).forEach(function(t){e.setAttribute(t,v[t])}),Object.keys(n).forEach(function(t){var e=n[t];e.setAttribute("cx",f[t].x),e.setAttribute("cy",f[t].y)})}function lt(t){return"g"===t.tagName.toLowerCase()}function ht(t){var n=[];return lt(t)?t.childNodes.forEach(function(t){if(1===t.nodeType){var e=t.tagName.toLowerCase();-1!==q.indexOf(e)&&("g"===e&&n.push.apply(n,J(ht(t))),n.push(t))}}):n.push(t),n}function ft(t){return t.match(at).reduce(function(t,e,n,r){return n%2==0&&t.push(r.slice(n,n+2)),t},[])}function pt(n){if(this.length){var r=new c;return i.call(this,function(t,e){return e instanceof SVGElement?function(t){var e=t.tagName.toLowerCase();return-1!==q.indexOf(e)||(Ot("Selected element is not allowed to transform. Allowed elements:\ncircle, ellipse, image, line, path, polygon, polyline, rect, text, g"),!1)}(e)&&t.push(new it(e,n,r)):t.push(new L(e,n,r)),t},[])}}function vt(t){return(vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function yt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var dt=function(){function n(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),this.el=t,this.options=e||{},this.storage=null,this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._animate=this._animate.bind(this),this.enable()}return function(t,e,n){e&&yt(t.prototype,e),n&&yt(t,n)}(n,[{key:"enable",value:function(){D(this.storage)?this._init():Ot("Already enabled")}},{key:"disable",value:function(){_destroy.call(this)}},{key:"_init",value:function(){var t=z(this.el),e=this.options,n=e.style,r=e.onDrop,o=e.appendTo,a=e.stack,i={position:"absolute","z-index":"2147483647"};N(n)&&"object"===vt(n)&&Object.assign(i,n);var s=N(a)?z(a)[0]:document,c=u(r)?function(t){var e=this.storage.clone;!function(t,e){var n=_(t),r=n.top,o=n.left,a=_(e),i=a.top,s=a.left,c=z(t),u=z(e);return!(r<i||r+parseFloat(c.css("height"))>i+parseFloat(u.css("height"))||o<s||o+parseFloat(c.css("width"))>s+parseFloat(u.css("width")))}(e,s)||r.call(this,t,this.el,e)}:function(){};this.storage={onDrop:c,options:this.options,css:i,parent:z(o)[0]||document.body,stack:s},t.on("mousedown",this._onMouseDown).on("touchstart",this._onTouchStart)}},{key:"_start",value:function(t){t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.storage,n=this.el,r=e.parent,o=e.css,a=_(r),i=t.clientX,s=t.clientY;o.left="".concat(i-a.left,"px"),o.top="".concat(s-a.top,"px");var c=n.cloneNode(!0);z(c).css(o),e.clientX=i,e.clientY=s,e.cx=i,e.cy=s,e.clone=c,z(r)[0].appendChild(c),this._draw()}},{key:"_move",value:function(t){t.preventDefault&&t.preventDefault();var e=this.storage;e.clientX=t.clientX,e.clientY=t.clientY,e.doDraw=!0,e.doMove=!0}},{key:"_end",value:function(t){t.stopImmediatePropagation&&t.stopImmediatePropagation();var e=this.storage,n=e.clone,r=e.frameId,o=e.onDrop;e.doDraw=!1,a(r),D(n)||(o.call(this,t),n.parentNode.removeChild(n),delete e.clone)}},{key:"_draw",value:function(){this._animate()}},{key:"_animate",value:function(){var t=this.storage;t.frameId=j(this._animate);var e=t.doDraw,n=t.clientX,r=t.clientY,o=t.cx,a=t.cy,i=t.clone;if(e){t.doDraw=!1;var s="translate(".concat(n-o,"px, ").concat(r-a,"px)");z(i).css({transform:s,webkitTranform:s,mozTransform:s,msTransform:s,otransform:s})}}},{key:"_destroy",value:function(){D(this.storage)||(z(this.el).off("mousedown",this._onMouseDown).off("touchstart",this._onTouchStart),delete this.storage)}},{key:"_onMouseDown",value:function(t){this._start(t),z(document).on("mousemove",this._onMouseMove).on("mouseup",this._onMouseUp)}},{key:"_onMouseMove",value:function(t){this._move(t)}},{key:"_onMouseUp",value:function(t){this._end(t),z(document).off("mousemove",this._onMouseMove).off("mouseup",this._onMouseUp)}},{key:"_onTouchStart",value:function(t){this._start(t.touches[0]),z(document).on("touchmove",this._onTouchMove).on("touchend",this._onTouchEnd)}},{key:"_onTouchMove",value:function(t){this._move(t.touches[0])}},{key:"_onTouchEnd",value:function(t){0===t.touches.length&&this._end(t.changedTouches[0]),z(document).off("touchmove",this._onTouchMove).off("touchend",this._onTouchEnd)}}]),n}();function mt(t){return(mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function gt(t,e){return!e||"object"!==mt(e)&&"function"!=typeof e?function(t){if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(t):e}function xt(t){return(xt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function _t(t,e){return(_t=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}
/* @license
 * Move/Rotate/Resize tool
 * Released under the MIT license, 2018-2019
 * nichollascarter@gmail.com
*/var wt=function(){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),gt(this,xt(e).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_t(t,e)}(e,f),function(t,e,n){e&&bt(t.prototype,e),n&&bt(t,n)}(e,[{key:"drag",value:function(t){return pt.call(this,t)}},{key:"clone",value:function(t){return function(e){if(this.length)return r.call(this,function(t){return new dt(t,e)})}.call(this,t)}}]),e}();e.default=function(t){return new wt(t)}}]).default;
//# sourceMappingURL=subjx.js.map